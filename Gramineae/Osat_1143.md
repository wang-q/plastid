# ğŸŒ¾ *Oryza sativa* indica 1143 accessions

[TOC levels=1-3]: # ""

- [ğŸŒ¾ *Oryza sativa* indica 1143 accessions](#-oryza-sativa-indica-1143-accessions)
  - [åŸºæœ¬ä¿¡æ¯](#åŸºæœ¬ä¿¡æ¯)
  - [é¡¹ç›®ä¿¡æ¯](#é¡¹ç›®ä¿¡æ¯)
  - [æ•°æ®ä¸‹è½½](#æ•°æ®ä¸‹è½½)
    - [Reference](#reference)
    - [Illumina](#illumina)
  - [Symlink](#symlink)
  - [Run](#run)
  - [Pack and clean](#pack-and-clean)
  - [VCF](#vcf)


## åŸºæœ¬ä¿¡æ¯

* Genome: GCA_000004655.2, Cultivar: 93-11, 426.337 Mb
* Chloroplast: [NC_008155](https://www.ncbi.nlm.nih.gov/nuccore/NC_008155), **Indica**, 134496 bp
* Mitochondrion: [NC_007886](https://www.ncbi.nlm.nih.gov/nuccore/NC_007886), **Indica**, 491515 bp


## é¡¹ç›®ä¿¡æ¯

* [PRJNA656900](https://trace.ncbi.nlm.nih.gov/Traces/study/?acc=PRJNA656900)

* <https://www.nature.com/articles/s41467-020-18608-0>

## æ•°æ®ä¸‹è½½

### Reference

```shell script
mkdir -p ~/data/plastid/Osat_1143/genome
cd ~/data/plastid/Osat_1143/genome

for ACCESSION in "NC_008155" "NC_007886"; do
    URL=$(printf "https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=nucleotide&rettype=%s&id=%s&retmode=text" "fasta" "${ACCESSION}");
    curl $URL -o ${ACCESSION}.fa
done

TAB=$'\t'
cat <<EOF > replace.tsv
NC_008155${TAB}Pt
NC_007886${TAB}Mt
EOF

cat NC_008155.fa NC_007886.fa |
    faops filter -s stdin stdout |
    faops replace stdin replace.tsv stdout |
    faops order stdin <(echo Pt; echo Mt) genome.fa

```

### Illumina

* Download `Metadata` from NCBI SRA Run Selector via a web browser
  * <https://trace.ncbi.nlm.nih.gov/Traces/study/?acc=PRJNA656900>
  * Save it to `SraRunTable.txt`


```shell script
mkdir -p ~/data/plastid/Osat_1143/ena
cd ~/data/plastid/Osat_1143/ena

cat SraRunTable.txt |
    mlr --icsv --otsv cat \
    > SraRunTable.tsv

cat <<EOF > pedigree.txt
6044
Ce64
DEE-GEO-WOO-GEN
Peta
TADUKUN
Tetep
# prefix
Guangchang
Huanghuazhan
IR
Mianhui
Minghui
Peiai
Qingsiai
Taiyin
Teqing
Texianzhan
Yuejingsimiao
Yuexiangzhan
Zhaiyeqing
Zhenguiai
Zhenzhuai
#
Aizizhan
Jingxian
Liantangzao
Zhenzhuzao
Nantehao
Guangqiuai
Muquanzhong
Guanger104
Guichao2hao
Qiguizao25
Gui630
Peidi
Aihuangmi
Gang46A
Chenghui448
Guanghui3550
EOF

cat SraRunTable.tsv |
    tsv-filter -H \
        --ge Bases:2000000000 \
        --le Bases:10000000000 | #wc -l
    tsv-select -H -f Experiment,Cultivar,geo_loc_name,Bases |
    perl -nla -F'\t' -e '
        $F[2] =~ s/china://i;
        print join qq(\t), @F;
    ' |
    keep-header -- tsv-sort -k4,4n | # sort by bases
    tsv-uniq -H \
        -f "Cultivar" --max 1 |
    mlr --itsv --ocsv cat |
    grep -f pedigree.txt |
    sort \
    > source.csv

anchr ena info | perl - -v source.csv > ena_info.yml
anchr ena prep | perl - ena_info.yml --ascp

mlr --icsv --omd cat ena_info.csv

cat ena_info.ascp.sh |
    parallel --no-run-if-empty -j 1 "{}"

```

| name                | srx        | platform | layout | ilength | srr         | spots    | bases |
|:--------------------|:-----------|:---------|:-------|:--------|:------------|:---------|:------|
| 6044                | SRX9013814 | ILLUMINA | PAIRED |         | SRR12523881 | 27692067 | 7.74G |
| Aihuangmi           | SRX9014014 | ILLUMINA | PAIRED |         | SRR12524330 | 26502344 | 7.4G  |
| Aizizhan            | SRX9014081 | ILLUMINA | PAIRED |         | SRR12524263 | 24847302 | 6.94G |
| BKN6819-33-3-2-1-3  | SRX9013307 | ILLUMINA | PAIRED |         | SRR12523679 | 21575637 | 6.03G |
| Ce64                | SRX9013320 | ILLUMINA | PAIRED |         | SRR12523666 | 29513684 | 8.25G |
| Chenghui448         | SRX9013350 | ILLUMINA | PAIRED |         | SRR12523636 | 26196738 | 7.32G |
| Colomlia            | SRX9013376 | ILLUMINA | PAIRED |         | SRR12523610 | 26882432 | 7.51G |
| Gang46A             | SRX9013449 | ILLUMINA | PAIRED |         | SRR12523537 | 24368210 | 6.81G |
| Gu154               | SRX9013473 | ILLUMINA | PAIRED |         | SRR12523513 | 20881390 | 5.83G |
| Gu223               | SRX9013474 | ILLUMINA | PAIRED |         | SRR12523512 | 28391756 | 7.93G |
| Gu34                | SRX9013472 | ILLUMINA | PAIRED |         | SRR12523514 | 24399298 | 6.82G |
| Guangchang13        | SRX9013477 | ILLUMINA | PAIRED |         | SRR12523509 | 23726716 | 6.63G |
| Guangchangai        | SRX9013478 | ILLUMINA | PAIRED |         | SRR12523508 | 21711376 | 6.07G |
| Guanger104          | SRX9013480 | ILLUMINA | PAIRED |         | SRR12523506 | 23926052 | 6.68G |
| Guanghui3550        | SRX9013489 | ILLUMINA | PAIRED |         | SRR12523497 | 24548440 | 6.86G |
| Guangqiuai          | SRX9013497 | ILLUMINA | PAIRED |         | SRR12523489 | 20491477 | 5.73G |
| Gui630              | SRX9013509 | ILLUMINA | PAIRED |         | SRR12523477 | 24729656 | 6.91G |
| Guichao2hao         | SRX9013512 | ILLUMINA | PAIRED |         | SRR12523474 | 25728794 | 7.19G |
| Huanghuazhan-1      | SRX9013572 | ILLUMINA | PAIRED |         | SRR12523414 | 22406825 | 6.26G |
| Huanghuazhan-2      | SRX9013573 | ILLUMINA | PAIRED |         | SRR12523413 | 22490906 | 6.28G |
| IR1112-116          | SRX9013604 | ILLUMINA | PAIRED |         | SRR12523382 | 25208964 | 7.04G |
| IR127-80-1-10       | SRX9013598 | ILLUMINA | PAIRED |         | SRR12523388 | 20664447 | 5.77G |
| IR13149-19-1        | SRX9013621 | ILLUMINA | PAIRED |         | SRR12523365 | 26353469 | 7.36G |
| IR13188-9           | SRX9013622 | ILLUMINA | PAIRED |         | SRR12523364 | 28829728 | 8.05G |
| IR13535-64-6-2-3-2  | SRX9013623 | ILLUMINA | PAIRED |         | SRR12523363 | 25293704 | 7.07G |
| IR14497-15-2        | SRX9013624 | ILLUMINA | PAIRED |         | SRR12523362 | 24449432 | 6.83G |
| IR15314-43-2-3-3    | SRX9013626 | ILLUMINA | PAIRED |         | SRR12523360 | 27904814 | 7.8G  |
| IR1544-181-1-1      | SRX9013605 | ILLUMINA | PAIRED |         | SRR12523381 | 20408896 | 5.7G  |
| IR15795-232-3-3-3-2 | SRX9013627 | ILLUMINA | PAIRED |         | SRR12523359 | 28599598 | 7.99G |
| IR15847-135-1-1     | SRX9013628 | ILLUMINA | PAIRED |         | SRR12523358 | 26392692 | 7.37G |
| IR15975-232-3-3-3-2 | SRX9013629 | ILLUMINA | PAIRED |         | SRR12523357 | 22679936 | 6.34G |
| IR18272-1-1-3       | SRX9013630 | ILLUMINA | PAIRED |         | SRR12523356 | 26891164 | 7.51G |
| IR18272-13-2        | SRX9013631 | ILLUMINA | PAIRED |         | SRR12523355 | 20396535 | 5.7G  |
| IR18272-27-3-1      | SRX9013632 | ILLUMINA | PAIRED |         | SRR12523354 | 29631563 | 8.28G |
| IR18342-66-2-1      | SRX9013633 | ILLUMINA | PAIRED |         | SRR12523353 | 26472456 | 7.4G  |
| IR18348-36-3-3      | SRX9013634 | ILLUMINA | PAIRED |         | SRR12523352 | 27677722 | 7.73G |
| IR19225-289-3-1-4   | SRX9013635 | ILLUMINA | PAIRED |         | SRR12523351 | 20989363 | 5.86G |
| IR19228-83-1-3      | SRX9013638 | ILLUMINA | PAIRED |         | SRR12523348 | 27163288 | 7.59G |
| IR19392-115-3       | SRX9013639 | ILLUMINA | PAIRED |         | SRR12523347 | 27794633 | 7.77G |
| IR19660-187-2-2-3-2 | SRX9013640 | ILLUMINA | PAIRED |         | SRR12523346 | 23024347 | 6.43G |
| IR19674-146-1-1-3-2 | SRX9013641 | ILLUMINA | PAIRED |         | SRR12523345 | 27423157 | 7.66G |
| IR19675-34-2-2-3-3A | SRX9013642 | ILLUMINA | PAIRED |         | SRR12523344 | 22025593 | 6.15G |
| IR19728-9-2-2-3-3   | SRX9013643 | ILLUMINA | PAIRED |         | SRR12523343 | 26360126 | 7.36G |
| IR2031-724-2-3-4    | SRX9013606 | ILLUMINA | PAIRED |         | SRR12523380 | 26635539 | 7.44G |
| IR2055              | SRX9013607 | ILLUMINA | PAIRED |         | SRR12523379 | 26273176 | 7.34G |
| IR2070-178-2-3      | SRX9013608 | ILLUMINA | PAIRED |         | SRR12523378 | 25875900 | 7.23G |
| IR2071-77-9-3-5     | SRX9013609 | ILLUMINA | PAIRED |         | SRR12523377 | 27086037 | 7.57G |
| IR2153-26-3-5-6     | SRX9013610 | ILLUMINA | PAIRED |         | SRR12523376 | 31322187 | 8.75G |
| IR2153-43-2-5-4     | SRX9013611 | ILLUMINA | PAIRED |         | SRR12523375 | 21758229 | 6.08G |
| IR2153-550-2-6      | SRX9013612 | ILLUMINA | PAIRED |         | SRR12523374 | 26824614 | 7.49G |
| IR21817-50-2        | SRX9013644 | ILLUMINA | PAIRED |         | SRR12523342 | 21741389 | 6.07G |
| IR21840-186-3       | SRX9013645 | ILLUMINA | PAIRED |         | SRR12523341 | 31279096 | 8.74G |
| IR21841-97-3-3      | SRX9013646 | ILLUMINA | PAIRED |         | SRR12523340 | 24889740 | 6.95G |
| IR21845-90-3Msp-2A  | SRX9013647 | ILLUMINA | PAIRED |         | SRR12523339 | 24595781 | 6.87G |
| IR21845-90-3Msp3aA  | SRX9013649 | ILLUMINA | PAIRED |         | SRR12523337 | 21746738 | 6.08G |
| IR21931-78-2-2      | SRX9013650 | ILLUMINA | PAIRED |         | SRR12523336 | 20731924 | 5.79G |
| IR24-1              | SRX9013585 | ILLUMINA | PAIRED |         | SRR12523401 | 31908719 | 8.92G |
| IR24-2              | SRX9013586 | ILLUMINA | PAIRED |         | SRR12523400 | 21187347 | 5.92G |
| IR24609-134-3-3     | SRX9013652 | ILLUMINA | PAIRED |         | SRR12523334 | 27609578 | 7.71G |
| IR2546-58-1         | SRX9013613 | ILLUMINA | PAIRED |         | SRR12523373 | 24240981 | 6.77G |
| IR25572-87-3-3      | SRX9013653 | ILLUMINA | PAIRED |         | SRR12523333 | 22620109 | 6.32G |
| IR25588-7-3-1       | SRX9013654 | ILLUMINA | PAIRED |         | SRR12524041 | 23460587 | 6.55G |
| IR25621-135-1-1     | SRX9013655 | ILLUMINA | PAIRED |         | SRR12524040 | 26413376 | 7.38G |
| IR25840-83-3-2      | SRX9013656 | ILLUMINA | PAIRED |         | SRR12524039 | 23829842 | 6.66G |
| IR25898-60-2-3      | SRX9013657 | ILLUMINA | PAIRED |         | SRR12524038 | 23626422 | 6.6G  |
| IR25924-92-1-3      | SRX9013658 | ILLUMINA | PAIRED |         | SRR12524037 | 28647797 | 8G    |
| IR25926-14-3-2      | SRX9013660 | ILLUMINA | PAIRED |         | SRR12524035 | 20361317 | 5.69G |
| IR26-1              | SRX9013587 | ILLUMINA | PAIRED |         | SRR12523399 | 27253723 | 7.61G |
| IR26-2              | SRX9013588 | ILLUMINA | PAIRED |         | SRR12523398 | 25374053 | 7.09G |
| IR27300-124-2       | SRX9013661 | ILLUMINA | PAIRED |         | SRR12524034 | 22201519 | 6.2G  |
| IR27301-62-3        | SRX9013662 | ILLUMINA | PAIRED |         | SRR12524033 | 29475817 | 8.24G |
| IR28-1              | SRX9013589 | ILLUMINA | PAIRED |         | SRR12523397 | 23789070 | 6.65G |
| IR28-2              | SRX9013590 | ILLUMINA | PAIRED |         | SRR12523396 | 22598944 | 6.31G |
| IR28212-71-4-2-3    | SRX9013663 | ILLUMINA | PAIRED |         | SRR12524032 | 22454542 | 6.27G |
| IR2863-6-3          | SRX9013615 | ILLUMINA | PAIRED |         | SRR12523371 | 25135346 | 7.02G |
| IR29670-15-2-3      | SRX9013664 | ILLUMINA | PAIRED |         | SRR12524031 | 26268972 | 7.34G |
| IR29692-65-2-3-3    | SRX9013665 | ILLUMINA | PAIRED |         | SRR12524030 | 27092437 | 7.57G |
| IR29708-113-3-2-2   | SRX9013666 | ILLUMINA | PAIRED |         | SRR12524029 | 23971773 | 6.7G  |
| IR29725-109-1-2-1   | SRX9013668 | ILLUMINA | PAIRED |         | SRR12524027 | 27865039 | 7.79G |
| IR29725-109-1-2-l   | SRX9013669 | ILLUMINA | PAIRED |         | SRR12524026 | 29914070 | 8.36G |
| IR29725-63-3-3-2    | SRX9013667 | ILLUMINA | PAIRED |         | SRR12524028 | 31136096 | 8.7G  |
| IR30                | SRX9013591 | ILLUMINA | PAIRED |         | SRR12523395 | 24713580 | 6.9G  |
| IR31775-30-3-2-2-2  | SRX9013671 | ILLUMINA | PAIRED |         | SRR12524024 | 31096959 | 8.69G |
| IR31802-48-2-2-2    | SRX9013672 | ILLUMINA | PAIRED |         | SRR12524023 | 27795520 | 7.77G |
| IR31805-20-1-3-3    | SRX9013673 | ILLUMINA | PAIRED |         | SRR12524022 | 29576578 | 8.26G |
| IR31851-63-1-2-3-2  | SRX9013674 | ILLUMINA | PAIRED |         | SRR12524021 | 22586786 | 6.31G |
| IR31906-67-1-1-2-2  | SRX9013675 | ILLUMINA | PAIRED |         | SRR12524020 | 29702563 | 8.3G  |
| IR32272-67-3-2-3    | SRX9013676 | ILLUMINA | PAIRED |         | SRR12524019 | 24522823 | 6.85G |
| IR32307-107-3-2-2   | SRX9013679 | ILLUMINA | PAIRED |         | SRR12524016 | 28564820 | 7.98G |
| IR32307-45-2-3-2    | SRX9013677 | ILLUMINA | PAIRED |         | SRR12524018 | 24930401 | 6.97G |
| IR32307-75-1-3-1    | SRX9013678 | ILLUMINA | PAIRED |         | SRR12524017 | 32462962 | 9.07G |
| IR32358-39-3-1-1    | SRX9013680 | ILLUMINA | PAIRED |         | SRR12524015 | 27857005 | 7.78G |
| IR32429-122-3-1-2   | SRX9013682 | ILLUMINA | PAIRED |         | SRR12524013 | 27947414 | 7.81G |
| IR32489-130-2-2-2   | SRX9013683 | ILLUMINA | PAIRED |         | SRR12524012 | 26538629 | 7.41G |
| IR32876-54-2-2-2    | SRX9013684 | ILLUMINA | PAIRED |         | SRR12524011 | 24024638 | 6.71G |
| IR34631-6-1-3       | SRX9013685 | ILLUMINA | PAIRED |         | SRR12524010 | 22616150 | 6.32G |
| IR34638-57-1-2      | SRX9013686 | ILLUMINA | PAIRED |         | SRR12524009 | 29393414 | 8.21G |
| IR34681-107-3-3-3   | SRX9013687 | ILLUMINA | PAIRED |         | SRR12524008 | 27787004 | 7.76G |
| IR35286-18-3-3-2-3  | SRX9013688 | ILLUMINA | PAIRED |         | SRR12524007 | 23932187 | 6.69G |
| IR36                | SRX9013593 | ILLUMINA | PAIRED |         | SRR12523393 | 23394866 | 6.54G |
| IR4422-480-2-3-3    | SRX9013617 | ILLUMINA | PAIRED |         | SRR12523369 | 22057394 | 6.16G |
| IR4422-51-1         | SRX9013616 | ILLUMINA | PAIRED |         | SRR12523370 | 22802179 | 6.37G |
| IR46829A            | SRX9013689 | ILLUMINA | PAIRED |         | SRR12524006 | 22274897 | 6.22G |
| IR46830A            | SRX9013690 | ILLUMINA | PAIRED |         | SRR12524005 | 20158052 | 5.63G |
| IR56                | SRX9013595 | ILLUMINA | PAIRED |         | SRR12523391 | 23020110 | 6.43G |
| IR5657-33-2         | SRX9013618 | ILLUMINA | PAIRED |         | SRR12523368 | 22033730 | 6.16G |
| IR58                | SRX9013596 | ILLUMINA | PAIRED |         | SRR12523390 | 26952170 | 7.53G |
| IR64                | SRX9013597 | ILLUMINA | PAIRED |         | SRR12523389 | 25322564 | 7.08G |
| IR661               | SRX9013599 | ILLUMINA | PAIRED |         | SRR12523387 | 24898618 | 6.96G |
| IR665               | SRX9013600 | ILLUMINA | PAIRED |         | SRR12523386 | 23718673 | 6.63G |
| IR749B2-44-2-37     | SRX9013601 | ILLUMINA | PAIRED |         | SRR12523385 | 20030009 | 5.6G  |
| IR8                 | SRX9013584 | ILLUMINA | PAIRED |         | SRR12523402 | 23525870 | 6.57G |
| IR841               | SRX9013602 | ILLUMINA | PAIRED |         | SRR12523384 | 29063595 | 8.12G |
| IR9828-91-2-3       | SRX9013619 | ILLUMINA | PAIRED |         | SRR12523367 | 27991814 | 7.82G |
| IR9859-6-3-3        | SRX9013620 | ILLUMINA | PAIRED |         | SRR12523366 | 26780648 | 7.48G |
| Jingxian89          | SRX9013730 | ILLUMINA | PAIRED |         | SRR12523965 | 27619105 | 7.72G |
| Jingxiang1A         | SRX9013731 | ILLUMINA | PAIRED |         | SRR12523964 | 20651176 | 5.77G |
| Juanye661           | SRX9013744 | ILLUMINA | PAIRED |         | SRR12523951 | 27542720 | 7.7G  |
| Lian24              | SRX9013771 | ILLUMINA | PAIRED |         | SRR12523924 | 25231974 | 7.05G |
| Liantangzao         | SRX9013773 | ILLUMINA | PAIRED |         | SRR12523922 | 24070698 | 6.73G |
| Mianhui146          | SRX9013846 | ILLUMINA | PAIRED |         | SRR12523849 | 22204424 | 6.2G  |
| Mianhui2009         | SRX9013851 | ILLUMINA | PAIRED |         | SRR12523844 | 29950187 | 8.37G |
| Mianhui2040         | SRX9013852 | ILLUMINA | PAIRED |         | SRR12523843 | 24219240 | 6.77G |
| Mianhui3724         | SRX9013853 | ILLUMINA | PAIRED |         | SRR12523842 | 21432640 | 5.99G |
| Mianhui501          | SRX9013848 | ILLUMINA | PAIRED |         | SRR12523847 | 27237888 | 7.61G |
| Mianhui662          | SRX9013849 | ILLUMINA | PAIRED |         | SRR12523846 | 23493949 | 6.56G |
| Mianhui725          | SRX9013850 | ILLUMINA | PAIRED |         | SRR12523845 | 21948987 | 6.13G |
| Mianhui9937         | SRX9013854 | ILLUMINA | PAIRED |         | SRR12523841 | 21987468 | 6.14G |
| Mianhui9939         | SRX9013855 | ILLUMINA | PAIRED |         | SRR12523840 | 29873238 | 8.35G |
| Minghui07           | SRX9013857 | ILLUMINA | PAIRED |         | SRR12523838 | 29995085 | 8.38G |
| Minghui100          | SRX9013868 | ILLUMINA | PAIRED |         | SRR12523827 | 22219151 | 6.21G |
| Minghui1259         | SRX9013869 | ILLUMINA | PAIRED |         | SRR12523826 | 24928107 | 6.96G |
| Minghui1273         | SRX9013871 | ILLUMINA | PAIRED |         | SRR12523824 | 25030113 | 6.99G |
| Minghui2155         | SRX9013872 | ILLUMINA | PAIRED |         | SRR12523823 | 20758525 | 5.8G  |
| Minghui63           | SRX9013860 | ILLUMINA | PAIRED |         | SRR12523835 | 24450750 | 6.83G |
| Minghui67           | SRX9013861 | ILLUMINA | PAIRED |         | SRR12523834 | 20560510 | 5.74G |
| Minghui70           | SRX9013862 | ILLUMINA | PAIRED |         | SRR12523833 | 26710191 | 7.46G |
| Minghui73           | SRX9013863 | ILLUMINA | PAIRED |         | SRR12523832 | 31674306 | 8.85G |
| Minghui77           | SRX9013864 | ILLUMINA | PAIRED |         | SRR12523831 | 21881822 | 6.11G |
| Minghui78           | SRX9013865 | ILLUMINA | PAIRED |         | SRR12523830 | 22028324 | 6.15G |
| Minghui82           | SRX9013866 | ILLUMINA | PAIRED |         | SRR12523829 | 27977425 | 7.82G |
| Minghui86           | SRX9013867 | ILLUMINA | PAIRED |         | SRR12523828 | 26851702 | 7.5G  |
| Muquanzhong         | SRX9013884 | ILLUMINA | PAIRED |         | SRR12523811 | 30996097 | 8.66G |
| Peiai64             | SRX9013930 | ILLUMINA | PAIRED |         | SRR12523765 | 27027905 | 7.55G |
| Peiai64S            | SRX9013931 | ILLUMINA | PAIRED |         | SRR12523764 | 26948568 | 7.53G |
| Peidi               | SRX9013932 | ILLUMINA | PAIRED |         | SRR12523763 | 27727480 | 7.75G |
| Qiguizao25          | SRX9013953 | ILLUMINA | PAIRED |         | SRR12523742 | 28807308 | 8.05G |
| Qingsiai16A         | SRX9013961 | ILLUMINA | PAIRED |         | SRR12523734 | 21280102 | 5.95G |
| R-6                 | SRX9013978 | ILLUMINA | PAIRED |         | SRR12523717 | 25348256 | 7.08G |
| S2876-S1-39-1-3     | SRX9014104 | ILLUMINA | PAIRED |         | SRR12524240 | 30398233 | 8.49G |
| Shenqi              | SRX9014116 | ILLUMINA | PAIRED |         | SRR12524228 | 32554428 | 9.1G  |
| Taiyin1hao          | SRX9014167 | ILLUMINA | PAIRED |         | SRR12524177 | 31109455 | 8.69G |
| Texianzhan13        | SRX9014173 | ILLUMINA | PAIRED |         | SRR12524171 | 26141845 | 7.3G  |
| Texianzhan25        | SRX9014174 | ILLUMINA | PAIRED |         | SRR12524170 | 23732272 | 6.63G |
| Yuejingsimiao2hao   | SRX8946546 | ILLUMINA | PAIRED |         | SRR12452051 | 22244199 | 6.21G |
| Yuexiangzhan        | SRX8946551 | ILLUMINA | PAIRED |         | SRR12452046 | 20644825 | 5.77G |
| Zhaiyeqing8hao      | SRX8946574 | ILLUMINA | PAIRED |         | SRR12452023 | 23501708 | 6.57G |
| Zhenguiai1hao       | SRX8946581 | ILLUMINA | PAIRED |         | SRR12452016 | 24285367 | 6.79G |
| Zhenzhuai           | SRX8946450 | ILLUMINA | PAIRED |         | SRR12452147 | 22628653 | 6.32G |
| Zhenzhuai11         | SRX8946451 | ILLUMINA | PAIRED |         | SRR12452146 | 23514581 | 6.57G |
| Zhenzhuzao          | SRX8946452 | ILLUMINA | PAIRED |         | SRR12452145 | 20130739 | 5.62G |


## Symlink

* é‡‡ç”¨çš„å€æ•°å› å­å€¼: `2`

* Rsync to hpcc

```shell script
rsync -avP \
    ~/data/plastid/Osat_1143/ \
    wangq@202.119.37.251:data/plastid/Osat_1143

# rsync -avP wangq@202.119.37.251:data/plastid/Osat_1143/ ~/data/plastid/Osat_1143

```

```shell script
cd ~/data/plastid/Osat_1143/

export FOLD=2
export GENOME_SIZE=$(
    cat ~/data/plastid/genome/nip/chr.sizes |
        tsv-summarize --sum 2
)

cat ena/ena_info.csv |
    mlr --icsv --otsv cat |
    tsv-select -H -f name,srr,bases |
    perl -nla -F'\t' -e '
        BEGIN { our %seen }
        /^name/ and next;
        $seen{$F[0]} and next;
        my $bases = $F[2];
        $bases =~ s/G$//;
        my $cutoff = $bases * 1000 * 1000 * 1000 / $ENV{GENOME_SIZE} * $ENV{FOLD};
        $cutoff = int $cutoff;
        print join qq(\t), ($F[0], $F[1], $cutoff);
        $seen{$F[0]}++;
    ' \
    > opts.tsv

cat opts.tsv |
    parallel --colsep '\t' --no-run-if-empty --linebuffer -k -j 1 '
        if [ ! -f ena/{2}_1.fastq.gz ]; then
            exit;
        fi
        if [ ! -f ena/{2}_2.fastq.gz ]; then
            exit;
        fi

        if [ -f {1}.tar.gz ]; then
            exit;
        fi

        mkdir -p {1}/1_genome
        pushd {1}/1_genome

        cp ../../genome/genome.fa genome.fa
        popd

        mkdir -p {1}/2_illumina
        pushd {1}/2_illumina

        ln -fs ../../ena/{2}_1.fastq.gz R1.fq.gz
        ln -fs ../../ena/{2}_2.fastq.gz R2.fq.gz
        popd
    '

```

## Run

```shell script
cd ~/data/plastid/Osat_1143/

cat opts.tsv | #head -n 20 | #tail -n 10 |
    parallel --colsep '\t' --no-run-if-empty --linebuffer -k -j 1 '
        if [ -f {1}.tar.gz ]; then
            exit;
        fi

        if [ ! -d {1} ]; then
            exit;
        fi

        if [ ! -e {1}/2_illumina/R1.fq.gz ]; then
            exit;
        fi
        if [ ! -e {1}/2_illumina/R2.fq.gz ]; then
            exit;
        fi

        if bjobs -w | tr -s " " | cut -d " " -f 7 | grep -w "^{1}$"; then
            echo Job {1} exists
            exit;
        fi

        cd {1}

        echo {1}

        rm *.sh
        anchr template \
            --genome 1000000 \
            --parallel 24 \
            --xmx 80g \
            \
            --fastqc \
            --insertsize \
            --kat \
            \
            --trim "--dedupe --cutoff {3} --cutk 31" \
            --qual "25" \
            --len "60" \
            --filter "adapter artifact" \
            \
            --bwa Q25L60 \
            --gatk

        bsub -q mpi -n 24 -J "{1}" "
            bash 2_fastqc.sh
            bash 2_insert_size.sh
            bash 2_kat.sh
            bash 2_trim.sh
            bash 9_stat_reads.sh
            bash 3_bwa.sh
            bash 3_gatk.sh
        "
    '

```

## Pack and clean

```shell script
cd ~/data/plastid/Osat_1143/

cat opts.tsv |
    parallel --colsep '\t' --no-run-if-empty --linebuffer -k -j 1 '
        if [ -f {1}.tar.gz ]; then
            echo "==> {1} .tar.gz"
            exit;
        fi

        if [ ! -f {1}/3_gatk/R.filtered.vcf ]; then
            echo "==> {1} 3_gatk"
            exit;
        fi

#        if [ ! -f {1}/7_merge_anchors/anchor.merge.fasta ]; then
#            echo "==> {1} 7_merge_anchors"
#            exit;
#        fi
#
#        if [ ! -d {1}/9_quast ]; then
#            echo "==> {1} 9_quast"
#            exit;
#        fi

        echo "==> Clean {1}"
        bash {1}/0_cleanup.sh

        echo "==> Create {1}.tar.gz"

        tar -czvf {1}.tar.gz \
            {1}/1_genome/genome.fa \
            {1}/2_illumina/fastqc \
            {1}/2_illumina/insert_size \
            {1}/2_illumina/kat \
            {1}/3_bwa/join.tsv \
            {1}/3_bwa/R.dedup.metrics \
            {1}/3_bwa/R.wgs.metrics \
            {1}/3_bwa/R.sort.bam \
            {1}/3_bwa/R.sort.bai \
            {1}/3_gatk \
            {1}/7_merge_anchors/anchor.merge.fasta \
            {1}/7_merge_anchors/others.non-contained.fasta \
            {1}/8_megahit/anchor/anchor.fasta \
            {1}/8_megahit/megahit.non-contained.fasta \
            {1}/8_mr_megahit/anchor/anchor.fasta \
            {1}/8_mr_megahit/megahit.non-contained.fasta \
            {1}/8_spades/anchor/anchor.fasta \
            {1}/8_spades/spades.non-contained.fasta \
            {1}/8_mr_spades/anchor/anchor.fasta \
            {1}/8_mr_spades/spades.non-contained.fasta \
            {1}/8_platanus/anchor/anchor.fasta \
            {1}/8_platanus/platanus.non-contained.fasta \
            {1}/9_quast \
            {1}/*.md

        echo
    '

cat opts.tsv |
    parallel --colsep '\t' --no-run-if-empty --linebuffer -k -j 1 '
        if [ -f {1}.tar.gz ]; then
            if [ -d {1} ]; then
                echo "==> Remove {1}/"
                rm -fr {1}
            fi
        fi
    '

```

* Unpack

```shell script
cd ~/data/plastid/Osat_1143/

cat opts.tsv |
    parallel --colsep '\t' --no-run-if-empty --linebuffer -k -j 1 '
        if [ -d {1} ]; then
            echo "==> {1} exists"
            exit;
        fi

        if [ ! -f {1}.tar.gz ]; then
            echo "==> {1}.tar.gz not exists"
            exit;
        fi

        tar -xzvf {1}.tar.gz
        rm {1}.tar.gz
    '

```

## VCF

```shell script
cd ~/data/plastid/Osat_1143/

mkdir -p vcf

cat opts.tsv |
    parallel --colsep '\t' --no-run-if-empty --linebuffer -k -j 4 '
        if [ ! -f {1}.tar.gz ]; then
            echo "==> {1}.tar.gz not exists"
            exit;
        fi

        tar -xOzvf {1}.tar.gz {1}/3_gatk/R.filtered.vcf |
            bcftools reheader --samples <(echo {1}) |
            bcftools view \
                --apply-filters PASS --types snps --max-alleles 2 --targets Pt -Oz |
            bcftools view --include "AF>0.01" -Oz -o vcf/{1}.vcf.gz

        bcftools index -f vcf/{1}.vcf.gz
    '

bcftools merge --merge all -l <(
        cat opts.tsv |
            cut -f 1 |
            xargs -I{} echo "vcf/{}.vcf.gz"
    ) \
    > Osat_1143.vcf

```

